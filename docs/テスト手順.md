# 請求書自動作成システム テスト手順書

## セットアップテスト

1. コードをデプロイ: `npm run deploy`
2. スクリプトエディタを開く: `npx clasp open`
3. スクリプトプロパティを初期化: `initializeProperties()` 関数を実行
4. スクリプトプロパティが正しく設定されたか確認

## 機能テスト

### テスト関数の実行

スクリプトエディタで `runTests()` 関数を実行し、各コンポーネントが正常に動作するか確認する。

テスト関数では以下のテストを行う：

- 実行タイミング判定: `shouldRunToday()` が期待通りに動作するか
- スクリプトプロパティ: すべてのプロパティが正しく読み取れるか
- 作業データ取得: 当月のデータが正しく抽出されるか
- 作業時間計算: 作業時間が正しく集計されるか

### 手動テスト

以下の関数を手動で実行して動作確認する：

1. `dailyTrigger()` - 自動実行をシミュレーションする
2. `createInvoice()` - 請求書を手動で生成する
3. `setDailyTrigger()` - 自動実行トリガーを設定する

## 自動実行テスト

トリガーを設定した後は以下の確認を行う：

1. トリガーが正しく設定されているか（スクリプトエディタの「トリガー」ページで確認）
2. `dailyTrigger()` が実行された際のログを確認（「実行ログ」で確認）
3. 出力フォルダに正しく PDF が生成されているか確認

## テスト結果の確認

生成された PDF ファイルについて以下を確認：

1. ファイル名が `yyyymmdd_金額_東顕正.pdf` の形式になっているか
2. 請求書の内容（作業時間、金額など）が正しいか
3. PDF の体裁が整っているか

## トラブルシューティング

エラーが発生した場合は以下を確認：

1. 「実行ログ」でエラーメッセージを確認
2. スクリプトプロパティが正しく設定されているか
3. 作業記録スプレッドシートの構造が想定通りか
4. 請求書テンプレートの指定セルが正しいか

## 回帰テスト

コードを変更した場合は毎回以下のテストを実施：

1. `runTests()` の実行
2. 手動での `createInvoice()` の実行
3. 生成された PDF の確認
