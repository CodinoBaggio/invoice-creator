# 請求書自動作成システム 設計書

## 📌 概要

Google Apps Script（GAS）を利用し、作業記録スプレッドシートから当月の作業時間を自動集計し、請求書テンプレートに値を差し込んでPDF出力・保存する自動化スクリプト。

---

## 🧾 処理フロー概要

```plaintext
[作業記録スプレッドシート]
  └─ 作業日・作業時間を月ごとに記録
         ↓
[Apps Script]
  └─ 当月の作業時間を抽出・合計
  └─ 請求書テンプレートをコピー
  └─ 指定セルへ「作業時間」「請求書番号」「日付」を反映
  └─ PDF出力しGoogle Driveへ保存（出力対象は "ダウンロード用" シート）
         ↓
[Google Drive]
  └─ 指定フォルダに `yyyymmdd_金額_宛名.pdf` で保存
         ↓
[Gmail]
  └─ 自分宛（codino.baggio10@gmail.com）に「請求書発行」のメールを自動送信
```

---

## 📄 GAS スクリプト仕様（TypeScript）

### スクリプト名

`createInvoice`

### 使用API

- `SpreadsheetApp`
    
- `DriveApp`
    
- `Utilities`
    
- `GmailApp`
    

### 入出力仕様

|項目|内容|
|---|---|
|入力元|作業記録スプレッドシート（作業日、作業時間）|
|出力先|Google Drive内の指定フォルダ|
|出力ファイル名|`<yyyymmdd>_<金額>_東顕正.pdf` 例: `20250531_49895_東顕正.pdf`|
|テンプレート処理|複製→「シート1」に必要値を入力→「ダウンロード用」シートをPDF化→命名・保存→元ファイル削除|
|作業時間集計方法|作業日が当月の行を抽出し、作業時間列の合計を算出|
|実行タイミング判定処理|毎日実行されるトリガー内で、処理日判定を行う：基本は月末の1日前。ただし土日であれば前倒しで木曜実行|
|完了通知処理|処理完了後、指定アドレス（`codino.baggio10@gmail.com`）へGmailで通知を送信|

#### 📧 通知メール仕様

- **宛先**: `codino.baggio10@gmail.com`
    
- **件名**: `請求書発行`
    
- **本文（成功時）**:
    
    ```
    請求書の発行を行いました。
    ```
    
- **本文（失敗時）**:
    
    ```
    請求書の発行を実行しましたがエラーになりました。エラー内容：◯◯
    ```
    

---

（以下略）